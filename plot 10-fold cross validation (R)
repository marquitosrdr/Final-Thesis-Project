########################
# CROSS-SET VALDATION  #
# Marcos Rusiñol       #
########################

hidden1 = c(8,30,58)
hidden2 = c(30,58,511)
library(lattice)

# Errors extracted from a Python program:

# Errores y accuracy con 30 epochs y dataset balanceado:
error_large_bal <- c(0.5879106260740636, 0.5869469537934132, 0.587212997124265, 0.5868662113366777, 0.5863306236859284, 0.5861172071296569, 0.5869836196648787, 0.5855662350006344, 0.5865979935995886, 0.5891524071763766, 0.5897866849827286, 0.6005531937925165, 0.5871896738601438, 0.588799640500604, 1.3607618151055947, 0.5872011189873663, 0.5886715327342936, 3.2884249237054544, 0.5953506146115788, 0.5925627991093795, 8.856658170338287, 0.5921586516455346, 0.5899753968684845, 1.010286623376024, 0.589349319722645, 0.5886941921295137, 7.163822660753855, 0.5752561553460784, 0.5740987989911597, 1.6123071238257396, 0.5753389535411391, 0.5735840947233048, 8.856658181378398, 0.5728515241796205, 0.5722941475172353, 7.163822657445808, 0.5572760173934473, 0.555595874721611, 2.315016832993565, 0.5548850950171261, 0.5543946563885335, 1.5240922864540212, 0.552258768925483, 0.5533494511506077, 7.16382265957146, 0.58322985206332, 0.5836430016884726, 5.633591033849617, 0.5818018678865956, 0.5813295647907148, 7.085504153215087, 0.5811441905666166, 0.5805159072318723, 8.954497686254, 0.5832254214929083, 0.5822421900623288, 8.954722237669344, 0.5813777175261055, 0.5807903090712552, 8.954722208906599, 0.5796287483453193, 0.5800866683996748, 8.954722239781711, 0.5811030472748444, 0.5828496269864288, 7.0852820747979814, 0.581113836872203, 0.5796945592996522, 7.085282063877438, 0.5805483883115794, 0.5786655802745942, 8.95472221596111, 0.5830188644976237, 0.5819276257274968, 1.5984745831813658, 0.580166130577968, 0.5802822786927303, 8.954722222178646, 0.5792683998348455, 0.5790440157025962, 7.0852820628411814, 0.5829104948247089, 0.5823751953378059, 8.95472223546398, 0.5827123279188517, 0.5811123283334789, 8.954722220610977, 0.5802741685327341, 0.581569536589605, 8.954722225991537)
accuracy_large_bal <- c(0.6808550662202181, 0.6798033010786252, 0.6812242295090256, 0.6821018629275104, 0.6814053285238829, 0.680179429397354, 0.6796222016585654, 0.6822829618277816, 0.681823249038188, 0.6799426074362407, 0.678988355226133, 0.668261731642751, 0.6800122606681898, 0.6787306377783568, 0.6526524018876982, 0.6798590233755606, 0.6793366228987457, 0.6134027074285539, 0.6722319751436543, 0.6752270719657757, 0.4444583726194303, 0.6756798180481748, 0.6774699113549801, 0.6685333782884836, 0.6771146790526669, 0.6778321082172459, 0.5555416223520714, 0.68831494714283, 0.6888512781278673, 0.6520533832885091, 0.6880154365047383, 0.6886423170055074, 0.4444583725405486, 0.689833390017583, 0.6910801867448033, 0.5555416224284621, 0.7031650523749878, 0.704056614981465, 0.6462582198008904, 0.7038685517786445, 0.7057909855545796, 0.6447049492863619, 0.7069054407797356, 0.7051153478034029, 0.5555416216927868, 0.6822272384098962, 0.682275996480673, 0.5923813109928704, 0.683731752359042, 0.6848810337293737, 0.5555555525389547, 0.684588488900886, 0.6855845328083701, 0.44444444199745226, 0.6850621325673699, 0.6840939498689679, 0.4444305111193164, 0.6847626227446654, 0.685424331047125, 0.44443051161544056, 0.6859119043350352, 0.6857795623978763, 0.4444305112924409, 0.6834670691556334, 0.684470078699182, 0.5555694836915157, 0.6848601382252738, 0.6852780577116263, 0.555569483572778, 0.6857029438055333, 0.686086037389998, 0.4444305111529449, 0.6832232829484336, 0.6832023868639308, 0.6200058508262073, 0.684762623284382, 0.6842193261534557, 0.4444305112127289, 0.6853477107891335, 0.6867407791463478, 0.5555694836707574, 0.6833068666886051, 0.6836203069448019, 0.4444305110433409, 0.683864094311147, 0.6841009151911663, 0.44443051131901157, 0.6855984635092297, 0.6847835195183448, 0.44443051119612226)

# Errores con 30 epochs y dataset sin balancear:
error_large_no_bal <- c(0.4622486513616592, 0.46356276408065017, 0.46093449376602746, 0.46119408646749877, 0.45979939899950495, 0.4604048877518698, 0.4602393593005029, 0.4599954252925459, 0.46041470041275395, 0.45590461918033315, 0.45553594938545505, 0.5160929918685825, 0.4541313809993258, 0.45475337600677, 0.9466858323451088, 0.4540735232282348, 0.45362462009543136, 3.210937919736729, 0.44774617689124874, 0.44719293085664685, 1.5190082768313362, 0.44669572180344835, 0.4459461649039947, 4.567973086563791, 0.4457932006799552, 0.4454239231587507, 2.32027847351925, 0.44063689933173183, 0.44441372845684585, 2.995553037157557, 0.44047520851502586, 0.4387510645395457, 1.2017271783445087, 0.4396009075743945, 0.4387597069395162, 3.321628254728941, 0.4539757638911597, 0.4516261429226958, 2.3615400909728455, 0.45080874282087163, 0.4502578766556782, 1.4496898180436806, 0.45020757589597576, 0.44907974995066535, 3.290289252291188, 0.4811980479024966, 0.47749250762553547, 1.7096469447683937, 0.47594310037556314, 0.4760299180820019, 3.2174078576161893, 0.47657511347764686, 0.4759750347032585, 3.9425592329937174, 0.47902433071124656, 0.47877340840553967, 11.968456818916295, 0.4772624686863005, 0.47910450412058153, 3.40083645431923, 0.476831502025977, 0.4761810867851729, 2.844297854270741, 0.4813060436523501, 0.4796480569418487, 1.7606172523118153, 0.4795242555713452, 0.47932315415427745, 3.206292520614492, 0.47854466741402435, 0.47906517898623413, 4.804747594560853, 0.48119944189662245, 0.4840146990622271, 2.3142228764957142, 0.47811955694557795, 0.47665106401022955, 1.4372066258456668, 0.4768119250730035, 0.4786515385549295, 2.9090359755709576, 0.4903662861900291, 0.48360003932102336, 1.728312682042363, 0.48306791065424975, 0.4836203186170516, 4.1460579679555964, 0.4834146945705443, 0.4819741007910172, 3.9429905449167135)
accuracy_large_no_bal <- c(0.7867924874328506, 0.7851134846716084, 0.7895067143748459, 0.7891735010941042, 0.7901796093437871, 0.7897461093808896, 0.7898722770927442, 0.7901925494367346, 0.7897008188882011, 0.793363589979363, 0.7940008976230558, 0.7917492938176741, 0.7950749376714998, 0.7942338217565968, 0.7883265969216542, 0.795061998059862, 0.7957575366212454, 0.7244017546232822, 0.8004289672057745, 0.8019106258598635, 0.7334502250517154, 0.8024314714743868, 0.802609399353803, 0.7003943525377869, 0.8030784838733269, 0.8031625948530806, 0.73155447810716, 0.8078113813107916, 0.8037157911651147, 0.7912963844111773, 0.8077628550471154, 0.8094192076719641, 0.7900929414656725, 0.808406632182805, 0.8097524189164007, 0.7939167857871602, 0.7916910623301865, 0.7944117500554071, 0.7514727612257097, 0.795220516266811, 0.796132803496803, 0.763762764668013, 0.796653648954174, 0.7973750683710946, 0.6461682272198506, 0.7735164795459224, 0.7764797968396385, 0.6965802134135974, 0.7791875453282655, 0.7792457758458445, 0.650687612215117, 0.778307607742961, 0.7789869708480891, 0.6622238459913063, 0.7797504458884177, 0.7796760387441372, 0.2492680668506974, 0.7802712905031445, 0.7793331224667855, 0.6969522469098024, 0.7804718643084342, 0.7813582718311605, 0.677263653066475, 0.7755480994078752, 0.7764506823482917, 0.7290440695392691, 0.7764895020441676, 0.7774988414659967, 0.6445636376150674, 0.7772368021517603, 0.7771138693801253, 0.6104110791295211, 0.7729244622431941, 0.770811967276957, 0.6731195376190284, 0.778556707432062, 0.7794787005192949, 0.7331752455994296, 0.7794204698031064, 0.7783367233642611, 0.6543594071216983, 0.7681248496742111, 0.7759247619393833, 0.7098018143308665, 0.7769373598993822, 0.77653943795417, 0.5952521139044438, 0.7765685543231369, 0.7777558492111518, 0.7553687077466015)


error_large <- error_large_no_bal
acc_large <- accuracy_large_no_bal

v_err_1 = error_large[1:9]
v_err_2 = error_large[10:18]
v_err_3 = error_large[19:27]
v_err_4 = error_large[28:36]
v_err_5 = error_large[37:45]
v_err_6 = error_large[46:54]
v_err_7 = error_large[55:63]
v_err_8 = error_large[64:72]
v_err_9 = error_large[73:81]
v_err_10 = error_large[82:90]

v_acc_1 = acc_large[1:9]
v_acc_2 = acc_large[10:18]
v_acc_3 = acc_large[19:27]
v_acc_4 = acc_large[28:36]
v_acc_5 = acc_large[37:45]
v_acc_6 = acc_large[46:54]
v_acc_7 = acc_large[55:63]
v_acc_8 = acc_large[64:72]
v_acc_9 = acc_large[73:81]
v_acc_10 = acc_large[82:90]


suma_error <- v_err_1+v_err_2+v_err_3+v_err_4+v_err_5+v_err_6+v_err_7+v_err_8+v_err_9+v_err_10
error_medio <- suma_error/10

suma_acc <- v_acc_1+v_acc_2+v_acc_3+v_acc_4+v_acc_5+v_acc_6+v_acc_7+v_acc_8+v_acc_9+v_acc_10
accuracy_medio <- suma_acc/10

err_medio <- matrix(error_medio,nrow = 3,ncol = 3)
dimnames(err_medio) <- list(N1=hidden1,N2=hidden2)
levelplot(err_medio,scales=list(x=list(rot=90)),xlab="N1",ylab="N2",main="Error rate")

acc_medio <- matrix(accuracy_medio,nrow = 3,ncol = 3)
dimnames(acc_medio) <- list(N1=hidden1,N2=hidden2)
levelplot(acc_medio,scales=list(x=list(rot=90)),xlab="N1",ylab="N2",main="Accuracy rate")


# FILTRADO

error <- c()
for (i in 1:length(error_medio)){
  if(error_medio[i]<0.60){
    error[i] <- error_medio[i]
  }
}

accuracy <- c()
for (i in 1:length(accuracy_medio)){
  if(accuracy_medio[i]>0.60){
    accuracy[i] <- accuracy_medio[i]
  }
}

err <- matrix(error,nrow = 3,ncol = 3)
dimnames(err) <- list(N1=hidden1,N2=hidden2)
levelplot(err,scales=list(x=list(rot=90)),xlab="N1",ylab="N2",main="Error rate")

acc <- matrix(accuracy,nrow = 3,ncol = 3)
dimnames(acc) <- list(N1=hidden1,N2=hidden2)
levelplot(acc,scales=list(x=list(rot=90)),xlab="N1",ylab="N2",main="Accuracy rate")


# Óptimo errores con 30 epochs y dataset balanceado:
# HIDDEN 1: 30
# HIDDEN 2: 511

# Óptimo accuracy con 30 epochs y dataset balanceado:
# HIDDEN 1: 30
# HIDDEN 2: 511

# Óptimo errores con 30 epochs y dataset no balanceado:
# HIDDEN 1: 30
# HIDDEN 2: 511

# Óptimo accuracy con 30 epochs y dataset no balanceado:
# HIDDEN 1: 30
# HIDDEN 2: 511




